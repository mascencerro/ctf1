/* 
 * ctf1
*/
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "b64.h"
typedef struct hjoldbtwxzdxtjgzperqhryy{char nsdrvewtpzmc[21];char apzcnwoeptkx[21];char qufzixxfxpym[2];int etafdcpwarbp;}box_t;char oyyakjzcxxxj[42];void hedcngafkvxq(){printf("\r\n\033[1;34mWhat have you found?: \033[1;37m%s\r\n",oyyakjzcxxxj);exit(0);}void vbwngkaltfmo(char *nsdrvewtpzmc,char *nmixacyznvzn,int zyiawdkgxtyi){box_t tjgzperqhryy;memset(&tjgzperqhryy.nsdrvewtpzmc,0,sizeof(tjgzperqhryy.nsdrvewtpzmc));memset(&tjgzperqhryy.apzcnwoeptkx,0,sizeof(tjgzperqhryy.apzcnwoeptkx));memset(&tjgzperqhryy.qufzixxfxpym,0,sizeof(tjgzperqhryy.qufzixxfxpym));tjgzperqhryy.etafdcpwarbp=1;strcpy(tjgzperqhryy.nsdrvewtpzmc,b64_decode(nmixacyznvzn,zyiawdkgxtyi));if(strncmp(tjgzperqhryy.qufzixxfxpym,"42",3)==0){if(tjgzperqhryy.etafdcpwarbp==0){hedcngafkvxq();}}else {strncpy(nsdrvewtpzmc,tjgzperqhryy.nsdrvewtpzmc,strlen(tjgzperqhryy.nsdrvewtpzmc));}}char*msg_encode(char *nsdrvewtpzmc,int itudynynbxox){char *nmixacyznvzn=b64_encode(nsdrvewtpzmc,itudynynbxox);return nmixacyznvzn;}void eqceuuhlfdxd(){printf("Usage: flag [OPTION] [INPUT]\r\n");printf("Options:\r\n");printf("\t-e Encode [INPUT] to Base64\r\n");printf("\t-d Decode Base64 [INPUT]\r\n");exit(0);}void lgdscefwglkn(){char dzlgxclfmgaz[]="TG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2NpbmcgZWxpdCwgc2VkIGRvIGVpdQZkbBQgEGVtaG9yIGluY2lkaWR1bnQgdXQgbGFib3JlIGV0IGRvbG9ymSBtYWduYSBhbGlxdWEuIFBvcnR0aXRvciBsSWNccyBs5WN0dXM9YWNjdW1zWW4gdG9ydG9yIHBvc3VlcmUgYWMgdUQuIExlY3R1cyBzaXQgYW1ldCBlc3QgcGxhY2ByYXmgaW4gZbdlc3Rhcy42Vm9sdXRwYXQg5GlhbSB1dCB2ZW5lbmF0aXMgdGVsbHVzIGluIG1ldHVzIHZ1bHB1dGF0ZS4gRmFjaWxpc2lzIgdyYXZpZGEgbmVxdWUgY29udmFsbGlzIGEgY3JhcyBzZW1wZXIgYXVjdG9yLiBFZ2VzdGFzIG0udGVnZlIgZWdldCBhb3lxdWV0IG5pYmguIEYsaXF1ZXQgcG9ydHRpdG9ylGxhY3VzIGx1Y3R1cyBhY2N1bXNhbiB0b3J0b3IuIExvcmVtIHNlZCByaXN1cyB1bHRyaWNpZXMgdHJpc3RpcXVlIG51bGxhIGFsaXc1ZXQgZW5pbSB0b3J0b3IuIFZlbCB0dXJwaXMgbnVuYyBlZ2V0IGxvcmVtIGRvbG9yLiBTb2NpaXMgbmF0b3F1ZSBwZW5hdGlidXMgZXQgbWFnbmlzIGRpcyBuYXJ0dXJpZW50LiBQdXV1cyBzaXQgYW1ldCB2b2x1dHBhdWBjb25zZXF1YXQgbWF1cmlzIG51bmMuIEluIG51bGxhIHBvc3VlcmUgc29sbGljaXR1ZGluIGFsaXF1YW0gdWx0cmljZXMuIFNpdCBhbWV0IHJpc3VzIG51bGxhbSBlZ2V0IGZlbGlzIGVnZXQuIElkIGFsaXF1ZXQgbGVjdHVzIHByb2luIG5pYmggbmlzbCBjb25kaW1lbnR1bS43RXN0IGFudGUgaW4gbmliaCBtYXVyaXMgY3Vyc3VzIG1hdHRpcyBtb2xlc3RpZSBhIGlhY3VsaXMuIExlbyBpbnRlZ2VyIG1hbGVzdWFkYSBudW5jIHZlbCByaXN1cyBjb21tb2RvLiBOaWJoIHRvcnRvciBpZCBhbGlxdWV0IGxlY3R1cyBwcmypbi4gQW1ldCByaXN1ayBudWxsYW0gZWdldCBmZWxpcyBlZ2VyIG51bmMgbG9ib3J0aXMgbWF0dGlzIGFsaXF1YW0uCgpxZCB2b2x1dHBhdCBsYWN1cyBsYW9yZWV0IG5vbiBjdXJhYml0dXIuIFZpdGFlIGNvbmd1ZSBtYXVyaXMgcmhvbmN1cyBhZW5lYW4gdmVsLiBFbGl0IHNlZCB2dWxwdXRhdGUgbWkgc2l0IGFtZXQgbWF1cmlzLiBDb25zZWN0ZXR1ciBsb3JlbSBkb25lYyBtYXNzYSBzYXBpZW4gZmF1Y2lidXMgZXQuIEludGVnZXIgbWFsZXN1YWRhIG51bmMgdmVsIHJpc3VzIGNvbW1vZG8gdml2ZXJyYSBtYWVjZW5hcyBhY2N1bXNhbiBsYWN1cy4gRXQgdG9ydV9yIGF0IHJpc3VzIHZpdmVycmEgYWRpcGlzY2luZyBhdCBpbiB0ZWxsdXMuIFByYWVzZW50IGVsZW1lbnR1bSBmYWNpbGlzaXMgbGVvIHZlbCBmcmluZ2lsbGEgZXN0IHVsbGFtY29ycGVyIGVnZXQuIEZldWdpYXQgaW4gYW50ZSBtZXR1cyBkaWN0dW0gYXQuIE51bmMgYWxpcXVldCBiaWJlbmR1bSBlbmltIGZhY2lsaXNpcyBncmF2aWRhLiBUZWxsdXMgaW4gaGFjIGhhYml0YXNzZSBwbGB0ZWEgZGljdHVtc3QgdmVzdGlidWxybSByaG9uY3VzIGVzdC4gVmVsIGZhY2lsaXNpcyB2b2x1dHBhdIBlc3QgdmVsaXQgZWdlc3RhcyBkdWkgaWQgb3JuYXJlLiBTdXNwZW5kaXNzZSBzZWQgbmlz0SBsYWN1cyBzZWQgdml2ZXJyYSB0ZWxsdXMuIFBlbGxlbnRlc3F1ZSBoYWJpdGFudCBtb3JiaSB0cmlzdGlxdWUgc2VuZWN0dXMgZXQgbmV0dXMuIEV0IG1hbGVzdWFkYSBmYW1lcyBhYyB0dXJwaXMgZWdlc3RhcyBzZWQgdGVtcHVzLgoKRmVsaXMgZWdldCBudW5jIGxvYm9ydGlzIG1hdHRpcyBhbGlxdWFtIGZhdWNpYnVzIHB1cnVzLiBFbGVtZW50dW0gbmliaCB0ZWxsdXMgbW9sZXN0aWUgbnVuYyBub24gYmxhbmRpdCBtYXNzYSBlbmltLiBFZ2V0IG1pIHByb2luIHNlZCBsaWJlcm8uIE1vbGVzdGllIGFjIGZldWdpYXQgc2VkIGxlY3R1cy4gVmVuZW5hdGlzIGNyYXMgc2VkIGZlbGlzIGVnZXQgdmVsaXQgYWxpcXVldC4gU2l0IGFtZXQgdm9sdXRwYXQgY29uc2VxdWF0IG1hdXJpcyBudW5jIGNvbmd1ZS4gTmV0dXMgyXQgbWFsZXN1YWRhIGZhbWVzIGFjIHR1cnBpcyBlZ2VzdGFzIG1hZWNlbmFzIHBoYXJldHJhIGNvbnZhbGxpcy4gQWxpcXVhbSBudWxsYSBmYWNpbGlzaSBjcmFzIGZlcm1lbnR1bSBvZGlvIGV1IGZldWdpYXQgcHJldGl1bSBuaWJoLiBFZ2VzdGFzIHNlZCB0ZW1wdXMgdXJuYSBldCBwaGFyZXRyYSBwaGFyZXRyYS4gVWx0cmljZXMgZHVpIHNhcGllbiBlZ2V0IG1pLiBOaXNsIGNvbmRpbWVudHVtIGlkIHZlbmVuYXRpcyBhIGNvbmRpbWVudHVtIHZpdGFlIHNhcGllbi4gRWxlaWZlbmQgcXVhbSBhZGlwaXNjaW5nIHZpdGFlIHByb2luLgoKTmliaCB0ZWxsdXMgbW9sZXN0aWUgbnVuYyBub24gYmxhbmRpdC4gQW1ldCBkaWN0dW0gc2l0IGFtZXQganVzdG8gZG9uZWMuIExhY3VzIGxhb3JlZXQgbm9uIGN1cmFiaXR1ciBncmF2aWRhIGFyY3UgYWMgdG9ydG9yLiBJbnRlZ2VyIG1hbGVzdWFkYSBudW5jIHZlbCByaXN1cyBjb21tb2RvIHZpdmVycmEgbWFlY2VuYXMgYWNjdW1zYW4gbGFjdXMuIFNpdCBhbWV0IHB1cnVzIGdyYXZpZGEgcXVpcyBibGFuZGl0IHR1cnBpcy4gSWQgaW50ZXJkdW0gdmVsaXQgbGFvcmVldCBpZC4gRW5pbSBmYWNpbGlzaXMgZ3JhdmlkYSBuZXF1ZSBjb252YWxsaXMuIEZlbGlzIGVnZXQgdmVsaXQgYWxpcXVldCBzYWdpdHRpcyBpZC4gQmxhbmRpdCBhbGlxdWFtIGV0aWFtIGVyYXQgdmVsaXQgc2NlbGVyaXNxdWUuIEFtZXQgdGVsbHVzIGNyYXMgYWRpcGlzY2luZyBlbmltIGV1IHR1cnBpcyBlZ2VzdGFzIHByZXRpdW0gYWVuZWFuLiBEaWFtIHZvbHV0cGF0IGNvbW1vZG8gc2VkIGVnZXN0YXMuIE1pIGJpYmVuZHVtIG5lcXVlIGVnZXN0YXMgY29uZ3VlIHF1aXNxdWUgZWdlc3RhcyBkaWFtIGluLgoKU2VkIGVnZXN0YXMgZWdlc3RhcyBmcmluZ2lsbGEgcGhhc2VsbHVzIGZhdWNpYnVzIHNjZWxlcmlzcXVlIGVsZWlmZW5kIGRvbmVjIHByZXRpdW0uIERpYW0gdm9sdXRwYXQgY29tbW9kbyBzZWQgZWdlc3RhcyBlZ2VzdGFzIGZyaW5naWxsYS4gRW5pbSB1dCB0ZWxsdXMgZWxlbWVudHVtIHNhZ2l0dGlzLiBOZXR1cyBldCBtYWxlc3VhZGEgZmFtZXMgYWMgdHVycGlzIGVnZXN0YXMgc2VkLiBGZXVnaWF0IG5pYmggc2VkIHB1bHZpbmFyIHByb2luIGdyYXZpZGEgaGVuZHJlcml0IGxlY3R1cy4gTWFsZXN1YWRhIGZhbWVzIGFjIHR1cnBpcyBlZ2VzdGFzIGludGVnZXIgZWdldCBhbGlxdWV0IG5pYmggcHJhZXNlbnQuIEluIGVzdCBhbnRlIGluIG5pYmggbWF1cmlzIGN1cnN1cy4gUmhvbmN1cyBlc3QgcGVsbGVudGVzcXVlIGVsaXQgdWxsYW1jb3JwZXIgZGlnbmlzc2ltLiBJcHN1bSBmYXVjaWJ1cyB2aXRhZSBhbGlxdWV0IG5lYy4gQ29udmFsbGlzIHRlbGx1cyBpZCBpbnRlcmR1bSB2ZWxpdCBsYW9yZWV0IGlkIGRvbmVjIHVsdHJpY2VzLiBVdCBwaGFyZXRyYSBzaXQgYW1ldCBhbGlxdWFtLiBQaGFzZWxsdXMgdmVzdGlidWx1bSBsb3JlbSBzZWQgcmlzdXMgdWx0cmljaWVzIHRyaXN0aXF1ZSBudWxsYSBhbGlxdWV0IGVuaW0uIE1hc3NhIHBsYWNlcmF0IGR1aXMgdWx0cmljaWVzIGxhY3VzIHNlZC4";memset(&oyyakjzcxxxj,0,sizeof(oyyakjzcxxxj));int evgmsnbcvqyw=89;int vwbydtlzisff=evgmsnbcvqyw;int oeyewgfhkmno=144;int jjeztnybdsch=0;int ldpwmxaxqlfe=5;int efpnfjlqhyjf=0;while((jjeztnybdsch<=ldpwmxaxqlfe)&&(efpnfjlqhyjf<40)){if(oeyewgfhkmno>=strlen(dzlgxclfmgaz)){jjeztnybdsch++;vwbydtlzisff=evgmsnbcvqyw+1;evgmsnbcvqyw=evgmsnbcvqyw+jjeztnybdsch;oeyewgfhkmno=evgmsnbcvqyw+vwbydtlzisff;}int dfntltxbdmjz=vwbydtlzisff;oyyakjzcxxxj[efpnfjlqhyjf]=dzlgxclfmgaz[vwbydtlzisff];vwbydtlzisff=oeyewgfhkmno;oeyewgfhkmno=dfntltxbdmjz+vwbydtlzisff;efpnfjlqhyjf++;}}int main(int gyleuhkvwayc,char **ixmbkqkmdilj){if((gyleuhkvwayc<=2)||(gyleuhkvwayc>3)){eqceuuhlfdxd();}if(strlen(ixmbkqkmdilj[1])!=2){eqceuuhlfdxd();}if((strncmp(ixmbkqkmdilj[1],"-e",3)!=0)&&(strncmp(ixmbkqkmdilj[1],"-d",3)!=0)){eqceuuhlfdxd();}lgdscefwglkn();if(strncmp(ixmbkqkmdilj[1],"-e",3)==0)printf("\033[1;37mEncoded message: \033[1;36m%s\r\n",msg_encode(ixmbkqkmdilj[2],strlen(ixmbkqkmdilj[2])));if(strncmp(ixmbkqkmdilj[1],"-d",3)==0){char nsdrvewtpzmc[strlen(ixmbkqkmdilj[2])];memset(&nsdrvewtpzmc,0,sizeof(nsdrvewtpzmc));vbwngkaltfmo(nsdrvewtpzmc,ixmbkqkmdilj[2],strlen(ixmbkqkmdilj[2]));printf("\033[1;37mDecoded message: \033[1;36m%s\r\n",nsdrvewtpzmc);}}